!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Vuelite=e()}(this,(function(){"use strict";function t(t,e,n){e=e.trim();let s=t;e.split(/[.[\]]/).filter(Boolean).forEach(((t,e,i)=>{if(e===i.length-1)s[t]=n;else if(/^\d+$/.test(t)){if(!Array.isArray(s))return;s=s[+t]}else{if(!Object.hasOwn(s,t))return;s=s[t]}}))}function e(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}const n=t=>"object"===e(t)||"array"===e(t);const s=t=>1===t.nodeType,i=t=>3===t.nodeType;class r{constructor(t){this.key=t,this.listener=new Set}subscribe(t){this.listener.add(t)}unsubscribe(t){this.listener.delete(t)}notify(){this.listener.forEach((t=>{t.update()}))}depend(){var t;null===(t=r.activated)||void 0===t||t.addDep(this)}}r.activated=null;class c{constructor(t){this.proxy=this.define(t)}define(t){const s=this,i=new Map,c=new Map;return new Proxy(t,{get(t,o,a){"symbol"!==e(o)&&(c.has(o)||c.set(o,new r(o)),c.get(o).depend());const h=t[o];return n(h)?(i.has(o)||i.set(o,s.define(h)),i.get(o)):Reflect.get(t,o,a)},set(t,e,n,s){const i=Reflect.set(t,e,n,s);return c.has(e)&&c.get(e).notify(),i}})}}function o(t){const{data:e}=t.options,n="function"==typeof e?e():{},s=new c(n).proxy;for(const e in n)Object.defineProperty(t,e,{configurable:!1,get:()=>s[e],set:t=>{s[e]=t}});!function(t){const{methods:e}=t.options;if(!e)return;Object.entries(e).forEach((([e,n])=>{if(Object.hasOwn(t,e))throw new Error(`${e} has already been declared`);Object.defineProperty(t,e,{value:(...e)=>n.apply(t,e)})}))}(t),function(t){const{computed:e}=t.options;if(!e)return;for(const n in e)if(Object.hasOwn(t,n))throw new Error(`${n} has already been declared`);Object.entries(e).forEach((([e,n])=>{const s={};!function(t){return"function"!=typeof t}(n)?s.get=()=>n.call(t):(s.get=n.get.bind(t),s.set=(...e)=>{n.set.apply(t,e)}),Object.defineProperty(t,e,s)}))}(t)}class a{constructor(t){const e=t.cssRules.length;t.insertRule("*{}",e),this.rule=t.cssRules[e]}selector(t){this.rule.selectorText=t}setStyle(t,e){this.rule.style[t]=e}}const h=["bind","model","text","style","class","html","eventHandler","if","show","for"];function l(t){const e=/{{\s*(.*?)\s*}}/g,n=[];let s;for(;null!==(s=e.exec(t));)n.push(s[1]);return n}function d(t){return t.startsWith("v-")||t.startsWith(":")||t.startsWith("@")}const u=t=>{if(s(t)){const e=t.attributes;return Array.from(e).some((t=>d(t.name)))}if(i(t)){return l(t.textContent||"").length>0}};const f={text(t,e){t.textContent=e},class(t,e){n(e)&&Object.entries(e).forEach((([e,n])=>{n&&t.classList.add(e)}))},style(t,e){for(const[s,i]of Object.entries(e))/^["'].*["']$/.test(n=i)&&n[0]===n[n.length-1]?t.style[s]=i.slice(1,-1):t.style[s]=i;var n},html(t,e){t.innerHTML=e},inputCheckbox(t,e){t.checked=e},inputRadio(t,e){t.checked=t.value===e},inputValue(t,e){t.value=e},inputMultiple(t,e){const n=Array.from(t.options);Array.isArray(e)&&n.forEach((t=>{t.selected=e.includes(t.value)}))},customBind(t,e){e&&t.setAttribute(this.modifier,e)},objectBind(t,e){n(e)&&Object.entries(e).forEach((([e,n])=>t.setAttribute(e,n)))},if(t,e){},else(t){},show(t,e){t.style.display=e?"":"none"}};function p(t,e){try{return new Function(`\n      with (this) {\n        return ${e};\n      }\n    `).call(t)}catch(t){return}}function m(t,e,n){return"text"===t?function(t,e){const n=l(e).reduce(((e,n)=>(e[n]=p(t,n),e)),{});return e.replace(/{{\s*(.*?)\s*}}/g,((t,e)=>n[e]||""))}(e,n):p(e,n)}class v{constructor(t,e,n,s){this.vm=t,this.exp=e,this.directiveName=n,this.onUpdate=s,this.deps=new Set,this.value=this.getterTrigger(),s(this.value)}addDep(t){t.subscribe(this),this.deps.add(t)}getterTrigger(){r.activated=this;const t=m(this.directiveName,this.vm,this.exp);return t.length,r.activated=null,t}update(){const t=this.value,e=this.getterTrigger();var n;(n=e)!==Object(n)&&t===e||(this.value=e,this.onUpdate.call(this.vm,e))}}class b{constructor(t,e,n,s){this.vm=t,this.el=e,this.name=n,this.exp=s,this.parent=e.parentElement||t.el,this.childIndex=Array.from(this.parent.children).indexOf(e),this.ifFragment=document.createDocumentFragment(),this.checkForElse(),this.render()}render(){new v(this.vm,this.exp,this.name,(t=>{this.updater(t)}))}checkForElse(){const t=this.el.nextElementSibling;(null==t?void 0:t.hasAttribute("v-else"))&&(this.elseElement=t,this.elseFragment=document.createDocumentFragment())}updater(t){if(t){const t=Array.from(this.parent.children)[this.childIndex];this.parent.insertBefore(this.ifFragment,t),this.elseElement&&this.elseFragment.appendChild(this.elseElement)}else if(this.ifFragment.appendChild(this.el),this.elseElement){const t=Array.from(this.parent.children)[this.childIndex];this.parent.insertBefore(this.elseFragment,t)}}}class g{visit(t,e){let n;const s=[e.firstChild];for(;n=s.pop();)if(n){if((i=n)instanceof HTMLElement&&i.hasAttribute("v-for")){t(n),n.nextSibling&&s.push(n.nextSibling);continue}t(n),n.firstChild&&s.push(n.firstChild),n.nextSibling&&s.push(n.nextSibling)}var i}}function y(t){switch(e(t)){case"string":case"array":return t.length;case"object":return Object.values(t).length;case"number":return Math.max(0,Number(t));default:return 0}}function x(t,n,s,i,r){const{alias:c,vm:o}=t,a=function(t,n,s,i){if("object"===e(i)){const e=Object.keys(i)[s];switch(t.length){case 1:return{[t[0]]:`${n}.${e}`};case 2:return{[t[0]]:`${n}.${e}`,[t[1]]:`${e}`};case 3:return{[t[0]]:`${n}.${e}`,[t[1]]:`${e}`,[t[2]]:s};default:return{}}}else if("number"===e(i))switch(t.length){case 1:return{[t[0]]:s+1};case 2:return{[t[0]]:s+1,[t[1]]:s};default:return{}}else switch(t.length){case 1:return{[t[0]]:`${n}[${s}]`};case 2:return{[t[0]]:`${n}[${s}]`,[t[1]]:s};default:return{}}}(c,s,i,r);A.context=a;const h=new O(new g).scanPartial(o,n);return A.context=null,h}class w{constructor(t,e,n){this.vm=t,this.el=e,this.exp=n,this.parent=e.parentElement||t.el;const s=function(t){let e=t.match(/^(.+?)\s+in\s+(.+)$/);return e?{key:e[1],list:e[2]}:(e=t.match(/^(.+?)\s+of\s+(.+)$/),e?{key:e[1],list:e[2]}:null)}(this.exp);if(!s)return;const{key:i,list:r}=s;this.listExp=r,this.alias=function(t){const e=t.match(/\(([^)]+)\)/);return e?e[1].split(",").map((t=>t.trim())).filter((t=>t)):[t]}(i),this.render()}render(){new v(this.vm,this.listExp,"for",(t=>{this.updater(t)}))}updater(t){const e=document.createDocumentFragment();Array.from({length:y(t)}).forEach(((n,s)=>{const i=this.el.cloneNode(!0);var r;(r=i).removeAttribute("v-for"),r.removeAttribute(":key"),r.removeAttribute("v-bind:key");const c=x(this,i,this.listExp,s,t);e.appendChild(c)})),this.parent.innerHTML="",this.parent.appendChild(e)}}class E{constructor(t,e,n,s){this.vm=e,this.node=n,this.exp=s;const{key:i,modifier:r}=function(t){if([":","@"].includes(t[0]))return":"===t.slice(0,1)?{key:"bind",modifier:t.slice(1)}:{key:"eventHandler",modifier:t.slice(1)};{const e=/^v-([\w-]+)(:(\w+))?$/,n=t.match(e);return{key:n[1],modifier:n[3]||null}}}(t);this.directiveName=i,this.modifier=r,(t=>h.includes(t))(i)&&(((t,e)=>t.startsWith("else")||"bind"===t&&"key"===e)(i,r)||("if"===i?e.deferredTasks.push((()=>new b(e,n,i,s))):"for"===i?e.deferredTasks.push((()=>new w(e,n,s))):(!function(t){return t.startsWith("v-on:")||t.startsWith("@")}(t)?this[i]():this.eventHandler(),n instanceof HTMLElement&&n.removeAttribute(t))))}bind(t){const e=this.modifier;"text"!==e&&"class"!==e&&"style"!==e||(t=f[e].bind(this)),t||(t=e?f.customBind.bind(this):f.objectBind.bind(this)),new v(this.vm,this.exp,this.directiveName,(e=>{t&&t(this.node,e)}))}model(){const e=this.node;switch(e.tagName){case"INPUT":{const n=e;"checkbox"===n.type?(n.addEventListener("change",(e=>{const n=e.target.checked;t(this.vm,this.exp,n)})),this.bind(f.inputCheckbox)):"radio"===n.type?(n.name=this.exp,n.addEventListener("change",(e=>{const n=e.target.value;t(this.vm,this.exp,n)})),this.bind(f.inputRadio)):(n.addEventListener("input",(e=>{const n=e.target.value;t(this.vm,this.exp,n)})),this.bind(f.inputValue));break}case"TEXTAREA":e.addEventListener("input",(e=>{const n=e.target.value;t(this.vm,this.exp,n)})),this.bind(f.inputValue);break;case"SELECT":{const n=e;n.multiple?(n.addEventListener("change",(e=>{const n=e.target,s=Array.from(n.selectedOptions).map((t=>t.value));t(this.vm,this.exp,s)})),this.bind(f.inputMultiple)):(n.addEventListener("change",(e=>{const n=e.target.value;t(this.vm,this.exp,n)})),this.bind(f.inputValue));break}default:throw new Error(`Unsupported element type: ${e.tagName}`)}}text(){this.bind(f.text.bind(this))}style(){this.bind(f.style)}class(){this.bind(f.class)}html(){this.bind(f.html)}show(){this.bind(f.show)}eventHandler(){const t=(e=this.vm,this.exp.trim().split(".").reduce(((t,e)=>t&&Object.hasOwn(t,e)?t[e]:null),e));var e;"function"==typeof t&&this.node.addEventListener(this.modifier,t)}}class k{constructor(t,e){this.vm=t,this.node=e;const n=e.textContent;s(e)?this.directiveBind(e):i(e)&&/{{\s*(.*?)\s*}}/.test(n)&&!(t=>{const e=null==t?void 0:t.attributes;if(e)return Array.from(e).some((t=>"v-text"===t.name))})(e.parentElement)&&this.templateBind(e)}directiveBind(t){Array.from(t.attributes).forEach((({name:e,value:n})=>{if(d(e)){const s=A.context||{};for(const t in s)n=n.replace(t,s[t]);new E(e,this.vm,t,n)}}))}templateBind(t){let e=t.textContent;const n=A.context||{};for(const t in n)e=e.replace(t,n[t]);new E("v-text",this.vm,t,e)}}class j{constructor(t){this.visitor=t}visit(t,e){this.visitor.visit(t,e)}}class O extends j{node2Fragment(t){const e=document.createDocumentFragment();let n;for(;n=t.firstChild;)e.appendChild(n);return e}scan(t){const e=e=>{u(e)&&new k(t,e)};t.template?(this.fragment=this.node2Fragment(t.template),t.el.innerHTML=""):this.fragment=this.node2Fragment(t.el),e(this.fragment),this.visit(e,this.fragment),t.el.appendChild(this.fragment),t.deferredTasks.forEach((t=>t()))}scanPartial(t,e){const n=this.node2Fragment(e),s=e=>{u(e)&&new k(t,e)};return s(n),this.visit(s,n),e.appendChild(n),e}}class A{constructor(t){this.deferredTasks=[],this.el=document.querySelector(t.el),this.options=t,this.template=function(t){if(!t)return;const e=document.createElement("div");return e.innerHTML=t,e.firstElementChild}(t.template),o(this),function(t){const{styles:e}=t.options;if(!e)return;const n=document.createElement("style");document.head.appendChild(n),Object.entries(e).forEach((([t,e])=>{const s=new a(n.sheet);s.selector(t),Object.entries(e).forEach((([t,e])=>{s.setStyle(t,e)}))}))}(this);new O(new g).scan(this)}}return A}));
