!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Vuelite=e()}(this,(function(){"use strict";function t(t,e,s){e=e.trim();let n=t;e.split(/[.[\]]/).filter(Boolean).forEach(((t,e,i)=>{if(e===i.length-1)n[t]=s;else if(/^\d+$/.test(t)){if(!Array.isArray(n))return;n=n[+t]}else{if(!Object.hasOwn(n,t))return;n=n[t]}}))}function e(t){const e=document.createDocumentFragment();let s;for(;s=t.firstChild;)e.appendChild(s);return e}function s(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}const n=t=>"object"===s(t)||"array"===s(t);const i=t=>1===t.nodeType,r=t=>3===t.nodeType;class o{constructor(t){this.key=t,this.listener=new Set}subscribe(t){this.listener.add(t)}unsubscribe(t){this.listener.delete(t)}notify(){this.listener.forEach((t=>{t.update()}))}depend(){var t;null===(t=o.activated)||void 0===t||t.addDep(this)}}o.activated=null;class c{static getStore(){return this.globalDeps}static addStore(t){this.globalDeps.push(t)}static forceUpdate(){this.globalDeps.forEach((t=>{for(const e of t.values())e.notify()}))}}c.globalDeps=[];class h{constructor(t){this.proxy=this.define(t)}define(t){const e=this,i=new Map,r=new Map;c.addStore(r);return new Proxy(t,{get(t,c,h){if("symbol"===s(c))return Reflect.get(t,c,h);r.has(c)||r.set(c,new o(c)),r.get(c).depend();const a=t[c];return n(a)?(i.has(c)||i.set(c,e.define(a)),i.get(c)):Reflect.get(t,c,h)},set(t,e,s,n){const i=t._length,o=Reflect.set(t,e,s,n);return i!==t._length&&r.has("_length")&&r.get("_length").notify(),r.has(e)&&r.get(e).notify(),o},deleteProperty(t,e){const s=t._length,n=Reflect.deleteProperty(t,e);return s!==t._length&&r.has("_length")&&r.get("_length").notify(),n}})}}function a(t){const{data:e}=t.options,s="function"==typeof e?e():{},n=new h(s).proxy;for(const e in s)Object.defineProperty(t,e,{configurable:!1,get:()=>n[e],set:t=>{n[e]=t}});!function(t){const{methods:e}=t.options;if(!e)return;Object.entries(e).forEach((([e,s])=>{if(Object.hasOwn(t,e))throw new Error(`${e} has already been declared`);Object.defineProperty(t,e,{value:(...e)=>s.apply(t,e)})}))}(t),function(t){const{computed:e}=t.options;if(!e)return;for(const s in e)if(Object.hasOwn(t,s))throw new Error(`${s} has already been declared`);Object.entries(e).forEach((([e,s])=>{const n={};!function(t){return"function"!=typeof t}(s)?n.get=()=>s.call(t):(n.get=s.get.bind(t),n.set=(...e)=>{s.set.apply(t,e)}),Object.defineProperty(t,e,n)}))}(t)}class l{constructor(t){const e=t.cssRules.length;t.insertRule("*{}",e),this.rule=t.cssRules[e]}selector(t){this.rule.selectorText=t}setStyle(t,e){this.rule.style[t]=e}}const d=["bind","model","text","style","class","html","on","if","show","for"];function u(t){const e=/{{\s*(.*?)\s*}}/g,s=[];let n;for(;null!==(n=e.exec(t));)s.push(n[1]);return s}function f(t){return t.startsWith("v-")||t.startsWith(":")||t.startsWith("@")}const p=t=>{if(i(t)){const e=t.attributes;return Array.from(e).some((t=>f(t.name)))}if(r(t)){return u(t.textContent||"").length>0}};const m={text(t,e){t.textContent=e},class(t,e){n(e)&&Object.entries(e).forEach((([e,s])=>{s&&t.classList.add(e)}))},style(t,e){for(const[n,i]of Object.entries(e))/^["'].*["']$/.test(s=i)&&s[0]===s[s.length-1]?t.style[n]=i.slice(1,-1):t.style[n]=i;var s},html(t,e){t.innerHTML=e},inputCheckbox(t,e){t.checked=e},inputRadio(t,e){t.checked=t.value===e},inputValue(t,e){t.value=e},inputMultiple(t,e){const s=Array.from(t.options);Array.isArray(e)&&s.forEach((t=>{t.selected=e.includes(t.value)}))},customBind(t,e){e&&t.setAttribute(this.modifier,e)},objectBind(t,e){n(e)&&Object.entries(e).forEach((([e,s])=>t.setAttribute(e,s)))},show(t,e){t.style.display=e?"":"none"}};function b(t,e){try{return new Function(`\n      with (this) {\n        return ${e};\n      }\n    `).call(t)}catch(t){return}}function g(t,e,s){return"text"===t?function(t,e){const s=u(e).reduce(((e,s)=>(e[s]=b(t,s),e)),{});return e.replace(/{{\s*(.*?)\s*}}/g,((t,e)=>s[e]||""))}(e,s):b(e,s)}class v{constructor(t,e,s,n,i){this.vm=t,this.exp=e,this.name=s,this.node=n,this.onUpdate=i,this.deps=new Set,this.value=this.getterTrigger(),i(this.value)}addDep(t){t.subscribe(this),this.deps.add(t)}getterTrigger(){o.activated=this;const t=g(this.name,this.vm,this.exp);return n(t)&&t._length,o.activated=null,t}update(){const t=this.value,e=this.getterTrigger();var s;(s=e)!==Object(s)&&t===e||(this.value=e,this.vm.updateQueue.push((()=>this.onUpdate(e))))}}class y{constructor(t,e,s){this.vm=t,this.el=e,this.exp=s,this.parent=e.parentElement||t.el,this.childIndex=Array.from(this.parent.children).indexOf(e),this.ifFragment=document.createDocumentFragment(),this.checkForElse(),this.render()}render(){new v(this.vm,this.exp,"if",this.el,(t=>{this.updater(t)}))}checkForElse(){const t=this.el.nextElementSibling;(null==t?void 0:t.hasAttribute("v-else"))&&(this.elseElement=t,this.elseFragment=document.createDocumentFragment())}updater(t){if(t){const t=this.parent.children[this.childIndex];this.parent.insertBefore(this.ifFragment,t),this.elseElement&&this.elseFragment.appendChild(this.elseElement)}else if(this.ifFragment.appendChild(this.el),this.elseElement){const t=this.parent.children[this.childIndex];this.parent.insertBefore(this.elseFragment,t)}}}class x{visit(t,e){let s;const n=[e.firstChild];for(;s=n.pop();)if(s){if((i=s)instanceof HTMLElement&&i.hasAttribute("v-for")){t(s),s.nextSibling&&n.push(s.nextSibling);continue}t(s),s.firstChild&&n.push(s.firstChild),s.nextSibling&&n.push(s.nextSibling)}var i}}function E(t,e,n,i){if("object"===s(i)){const s=Object.keys(i)[n];switch(t.length){case 1:return{[t[0]]:`${e}.${s}`};case 2:return{[t[0]]:`${e}.${s}`,[t[1]]:`"${s}"`};case 3:return{[t[0]]:`${e}.${s}`,[t[1]]:`"${s}"`,[t[2]]:n};default:return{}}}else if("number"===s(i))switch(t.length){case 1:return{[t[0]]:n+1};case 2:return{[t[0]]:n+1,[t[1]]:n};default:return{}}else switch(t.length){case 1:return{[t[0]]:`${e}[${n}]`};case 2:return{[t[0]]:`${e}[${n}]`,[t[1]]:n};default:return{}}}function w(t,e){return t?(Object.keys(t).forEach((s=>{const n=new RegExp(`\\b${s}\\b`,"g");e=e.replace(n,t[s])})),e):e}class k{constructor(t,e){this.loop=t,this.data=e,this.scanner=new A(new x)}bind(t,e){const{alias:s,vm:n,loopEffects:i,listExp:r,parentContext:o}=this.loop,c={...o,...E(s,r,e,this.data)};L.context=c;const h=this.scanner.scanPartial(n,t,i);return L.context=null,h}}class C{constructor(t,e,s,n){this.vm=t,this.el=e,this.exp=s,this.parentContext=n,this.loopEffects=[],this.parent=e.parentElement||t.el,this.startIndex=Array.from(this.parent.children).indexOf(e);const i=function(t){let e=t.match(/^(.+?)\s+in\s+(.+)$/);return e?{key:e[1],list:e[2]}:(e=t.match(/^(.+?)\s+of\s+(.+)$/),e?{key:e[1],list:e[2]}:null)}(this.exp);if(!i)return;const{key:r,list:o}=i;this.listExp=o,this.alias=function(t){const e=t.match(/\(([^)]+)\)/);return e?e[1].split(",").map((t=>t.trim())).filter((t=>t)):[t]}(r),this.render()}render(){new v(this.vm,this.listExp,"for",this.el,(t=>{this.updater(t)}))}updater(t){const e=document.createDocumentFragment(),n=function(t){switch(s(t)){case"string":case"array":return t.length;case"object":return Object.values(t).length;case"number":return Math.max(0,Number(t));default:return 0}}(t),i=this.startIndex+n-1,r=new k(this,t);if(Array.from({length:n}).forEach(((t,s)=>{const n=this.el.cloneNode(!0);var i;(i=n).removeAttribute("v-for"),i.removeAttribute(":key"),i.removeAttribute("v-bind:key");const o=r.bind(n,s);e.appendChild(o)})),this.el.isConnected)this.parent.replaceChild(e,this.el),this.endIndex=i;else{for(let t=this.endIndex;t>=this.startIndex;t--){const e=this.parent.children[t];e&&this.parent.removeChild(e)}this.el.remove();const t=this.parent.children[this.startIndex];this.parent.insertBefore(e,t),this.endIndex=this.startIndex+n-1}this.clearEffects()}clearEffects(){this.loopEffects.forEach((t=>t())),this.loopEffects=[]}}class O{constructor(t,e,s,n,i){this.vm=e,this.node=s,this.exp=n;const{key:r,modifier:o}=function(t){if([":","@"].includes(t[0]))return":"===t.slice(0,1)?{key:"bind",modifier:t.slice(1)}:{key:"on",modifier:t.slice(1)};{const e=/^v-([\w-]+)(:(\w+))?$/,s=t.match(e);return{key:s[1],modifier:s[3]||null}}}(t);this.name=r,this.modifier=o,(t=>d.includes(t))(r)&&(((t,e)=>t.startsWith("else")||"bind"===t&&"key"===e)(r,o)||(!function(t){return"if"===t||"for"===t}(r)?(!function(t){return t.startsWith("v-on:")||t.startsWith("@")}(t)?this[r]():this.on(),s instanceof HTMLElement&&s.removeAttribute(t)):this.scheduleTask(r,i)))}bind(t){t=this.selectUpdater(t),new v(this.vm,this.exp,this.name,this.node,((e,s)=>{t(s||this.node,e)}))}model(){const e=this.node;switch(e.tagName){case"INPUT":{const s=e;"checkbox"===s.type?(s.addEventListener("change",(e=>{const s=e.target.checked;t(this.vm,this.exp,s)})),this.bind(m.inputCheckbox)):"radio"===s.type?(s.name=this.exp,s.addEventListener("change",(e=>{const s=e.target.value;t(this.vm,this.exp,s)})),this.bind(m.inputRadio)):(s.addEventListener("input",(e=>{const s=e.target.value;t(this.vm,this.exp,s)})),this.bind(m.inputValue));break}case"TEXTAREA":e.addEventListener("input",(e=>{const s=e.target.value;t(this.vm,this.exp,s)})),this.bind(m.inputValue);break;case"SELECT":{const s=e;s.multiple?(s.addEventListener("change",(e=>{const s=e.target,n=Array.from(s.selectedOptions).map((t=>t.value));t(this.vm,this.exp,n)})),this.bind(m.inputMultiple)):(s.addEventListener("change",(e=>{const s=e.target.value;t(this.vm,this.exp,s)})),this.bind(m.inputValue));break}default:throw new Error(`Unsupported element type: ${e.tagName}`)}}text(){this.bind(m.text.bind(this))}style(){this.bind(m.style)}class(){this.bind(m.class)}html(){this.bind(m.html)}show(){this.bind(m.show)}on(){const t=(e=this.vm,this.exp.trim().split(".").reduce(((t,e)=>t&&Object.hasOwn(t,e)?t[e]:null),e));var e;if("function"==typeof t)this.node.addEventListener(this.modifier,t);else{const t=b(this.vm,`function(){ ${this.exp} }`);this.node.addEventListener(this.modifier,t)}}scheduleTask(t,e){const s={...L.context},n="if"===t?y:C,i=()=>new n(this.vm,this.node,this.exp,s);e?e.push(i):this.vm.deferredTasks.push(i)}selectUpdater(t){const e=this.modifier;return"text"===e||"class"===e||"style"===e?m[e].bind(this):t||(e?m.customBind.bind(this):m.objectBind.bind(this))}}class j{constructor(t,e,s){this.vm=t,this.node=e,this.loopEffects=s;const n=e.textContent;i(e)?this.directiveBind(e):r(e)&&/{{\s*(.*?)\s*}}/.test(n)&&!(t=>{const e=null==t?void 0:t.attributes;if(e)return Array.from(e).some((t=>"v-text"===t.name))})(e.parentElement)&&this.templateBind(e)}directiveBind(t){Array.from(t.attributes).forEach((({name:e,value:s})=>{if(f(e)){s=w(L.context,s),new O(e,this.vm,t,s,this.loopEffects)}}))}templateBind(t){let e=t.textContent;e=w(L.context,e),new O("v-text",this.vm,t,e)}}class T{constructor(t){this.visitor=t}visit(t,e){this.visitor.visit(t,e)}}class A extends T{scan(t){const s=e=>{p(e)&&new j(t,e)};t.template?(this.fragment=e(t.template),t.el.innerHTML=""):this.fragment=e(t.el),s(this.fragment),this.visit(s,this.fragment),t.el.appendChild(this.fragment),t.clearTasks()}scanPartial(t,s,n){const i=e(s),r=e=>{p(e)&&new j(t,e,n)};return r(i),this.visit(r,i),s.appendChild(i),s}}class ${constructor(){this.deferredTasks=[]}setHooks(t){this.hooks=t}callHook(t){const e=this.hooks[t];"function"===s(e)&&("beforeCreate"===t?e.call(null):e.call(this))}clearTasks(){this.deferredTasks.forEach((t=>t())),this.deferredTasks=[]}}class L extends ${constructor(t){super(),this.updateQueue=[],this.options=t,this.setHooks(t),this.el=document.querySelector(t.el),this.template=function(t){if(!t)return;const e=document.createElement("div");return e.innerHTML=t,e.firstElementChild}(t.template),this.callHook("beforeCreate"),a(this),function(t){const{styles:e}=t.options;if(!e)return;const s=document.createElement("style");document.head.appendChild(s),Object.entries(e).forEach((([t,e])=>{const n=new l(s.sheet);n.selector(t),Object.entries(e).forEach((([t,e])=>{n.setStyle(t,e)}))}))}(this),this.callHook("created");new A(new x).scan(this),this.callHook("mounted"),requestAnimationFrame((()=>this.render()))}render(){if(this.updateQueue.length>0){for(this.callHook("beforeUpdate");this.updateQueue.length>0;){const t=this.updateQueue.shift();"function"===s(t)&&t()}this.callHook("updated")}requestAnimationFrame((()=>this.render()))}}return L}));
