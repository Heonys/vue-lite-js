!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Vuelite=e()}(this,(function(){"use strict";function t(t,e,s){e=e.trim();let n=t;e.split(/[.[\]]/).filter(Boolean).forEach(((t,e,i)=>{if(e===i.length-1)n[t]=s;else if(/^\d+$/.test(t)){if(!Array.isArray(n))return;n=n[+t]}else{if(!Object.hasOwn(n,t))return;n=n[t]}}))}function e(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}const s=t=>"object"===e(t)||"array"===e(t);const n=t=>1===t.nodeType,i=t=>3===t.nodeType;class r{constructor(t){this.key=t,this.listener=new Set}subscribe(t){this.listener.add(t)}unsubscribe(t){this.listener.delete(t)}notify(){this.listener.forEach((t=>{t.update()}))}depend(){var t;null===(t=r.activated)||void 0===t||t.addDep(this)}}r.activated=null;class o{static getStore(){return this.globalDeps}static addStore(t){this.globalDeps.push(t)}static forceUpdate(){this.globalDeps.forEach((t=>{for(const e of t.values())e.notify()}))}}o.globalDeps=[];class c{constructor(t){this.proxy=this.define(t)}define(t){const n=this,i=new Map,c=new Map;o.addStore(c);return new Proxy(t,{get(t,o,a){if("symbol"===e(o))return Reflect.get(t,o,a);c.has(o)||c.set(o,new r(o)),c.get(o).depend();const h=t[o];return s(h)?(i.has(o)||i.set(o,n.define(h)),i.get(o)):Reflect.get(t,o,a)},set(t,e,s,n){const i=t._length,r=Reflect.set(t,e,s,n);return i!==t._length&&c.has("_length")&&c.get("_length").notify(),c.has(e)&&c.get(e).notify(),r}})}}function a(t){const{data:e}=t.options,s="function"==typeof e?e():{},n=new c(s).proxy;for(const e in s)Object.defineProperty(t,e,{configurable:!1,get:()=>n[e],set:t=>{n[e]=t}});!function(t){const{methods:e}=t.options;if(!e)return;Object.entries(e).forEach((([e,s])=>{if(Object.hasOwn(t,e))throw new Error(`${e} has already been declared`);Object.defineProperty(t,e,{value:(...e)=>s.apply(t,e)})}))}(t),function(t){const{computed:e}=t.options;if(!e)return;for(const s in e)if(Object.hasOwn(t,s))throw new Error(`${s} has already been declared`);Object.entries(e).forEach((([e,s])=>{const n={};!function(t){return"function"!=typeof t}(s)?n.get=()=>s.call(t):(n.get=s.get.bind(t),n.set=(...e)=>{s.set.apply(t,e)}),Object.defineProperty(t,e,n)}))}(t)}class h{constructor(t){const e=t.cssRules.length;t.insertRule("*{}",e),this.rule=t.cssRules[e]}selector(t){this.rule.selectorText=t}setStyle(t,e){this.rule.style[t]=e}}const l=["bind","model","text","style","class","html","on","if","show","for"];function d(t){const e=/{{\s*(.*?)\s*}}/g,s=[];let n;for(;null!==(n=e.exec(t));)s.push(n[1]);return s}function u(t){return t.startsWith("v-")||t.startsWith(":")||t.startsWith("@")}const f=t=>{if(n(t)){const e=t.attributes;return Array.from(e).some((t=>u(t.name)))}if(i(t)){return d(t.textContent||"").length>0}};const p={text(t,e){t.textContent=e},class(t,e){s(e)&&Object.entries(e).forEach((([e,s])=>{s&&t.classList.add(e)}))},style(t,e){for(const[n,i]of Object.entries(e))/^["'].*["']$/.test(s=i)&&s[0]===s[s.length-1]?t.style[n]=i.slice(1,-1):t.style[n]=i;var s},html(t,e){t.innerHTML=e},inputCheckbox(t,e){t.checked=e},inputRadio(t,e){t.checked=t.value===e},inputValue(t,e){t.value=e},inputMultiple(t,e){const s=Array.from(t.options);Array.isArray(e)&&s.forEach((t=>{t.selected=e.includes(t.value)}))},customBind(t,e){e&&t.setAttribute(this.modifier,e)},objectBind(t,e){s(e)&&Object.entries(e).forEach((([e,s])=>t.setAttribute(e,s)))},show(t,e){t.style.display=e?"":"none"}};function m(t,e){try{return new Function(`\n      with (this) {\n        return ${e};\n      }\n    `).call(t)}catch(t){return}}function b(t,e,s){return"text"===t?function(t,e){const s=d(e).reduce(((e,s)=>(e[s]=m(t,s),e)),{});return e.replace(/{{\s*(.*?)\s*}}/g,((t,e)=>s[e]||""))}(e,s):m(e,s)}class v{constructor(t,e,s,n){this.vm=t,this.exp=e,this.directiveName=s,this.onUpdate=n,this.deps=new Set,this.value=this.getterTrigger(),n(this.value)}addDep(t){t.subscribe(this),this.deps.add(t)}getterTrigger(){r.activated=this;const t=b(this.directiveName,this.vm,this.exp);return s(t)&&t._length,r.activated=null,t}update(){const t=this.value,e=this.getterTrigger();var s;(s=e)!==Object(s)&&t===e||(this.value=e,this.onUpdate.call(this.vm,e))}}class g{constructor(t,e,s){this.vm=t,this.el=e,this.exp=s,this.parent=e.parentElement||t.el,this.childIndex=Array.from(this.parent.children).indexOf(e),this.ifFragment=document.createDocumentFragment(),this.checkForElse(),this.render()}render(){new v(this.vm,this.exp,"if",(t=>{this.updater(t)}))}checkForElse(){const t=this.el.nextElementSibling;(null==t?void 0:t.hasAttribute("v-else"))&&(this.elseElement=t,this.elseFragment=document.createDocumentFragment())}updater(t){if(t){const t=this.parent.children[this.childIndex];this.parent.insertBefore(this.ifFragment,t),this.elseElement&&this.elseFragment.appendChild(this.elseElement)}else if(this.ifFragment.appendChild(this.el),this.elseElement){const t=this.parent.children[this.childIndex];this.parent.insertBefore(this.elseFragment,t)}}}class x{visit(t,e){let s;const n=[e.firstChild];for(;s=n.pop();)if(s){if((i=s)instanceof HTMLElement&&i.hasAttribute("v-for")){t(s),s.nextSibling&&n.push(s.nextSibling);continue}t(s),s.firstChild&&n.push(s.firstChild),s.nextSibling&&n.push(s.nextSibling)}var i}}function y(t,s,n,i){if("object"===e(i)){const e=Object.keys(i)[n];switch(t.length){case 1:return{[t[0]]:`${s}.${e}`};case 2:return{[t[0]]:`${s}.${e}`,[t[1]]:`"${e}"`};case 3:return{[t[0]]:`${s}.${e}`,[t[1]]:`"${e}"`,[t[2]]:n};default:return{}}}else if("number"===e(i))switch(t.length){case 1:return{[t[0]]:n+1};case 2:return{[t[0]]:n+1,[t[1]]:n};default:return{}}else switch(t.length){case 1:return{[t[0]]:`${s}[${n}]`};case 2:return{[t[0]]:`${s}[${n}]`,[t[1]]:n};default:return{}}}function E(t,e){return t?(Object.keys(t).forEach((s=>{const n=new RegExp(`\\b${s}\\b`,"g");e=e.replace(n,t[s])})),e):e}class w{constructor(t){this.loop=t,this.scanner=new T(new x)}bind(t,e,s){const{alias:n,vm:i,loopEffects:r,listExp:o,parentContext:c}=this.loop,a={...c,...y(n,o,e,s)};$.context=a;const h=this.scanner.scanPartial(i,t,r);return $.context=null,h}}class k{constructor(t,e,s,n){this.vm=t,this.el=e,this.exp=s,this.parentContext=n,this.loopEffects=[],this.parent=e.parentElement||t.el,this.startIndex=Array.from(this.parent.children).indexOf(e);const i=function(t){let e=t.match(/^(.+?)\s+in\s+(.+)$/);return e?{key:e[1],list:e[2]}:(e=t.match(/^(.+?)\s+of\s+(.+)$/),e?{key:e[1],list:e[2]}:null)}(this.exp);if(!i)return;const{key:r,list:o}=i;this.listExp=o,this.alias=function(t){const e=t.match(/\(([^)]+)\)/);return e?e[1].split(",").map((t=>t.trim())).filter((t=>t)):[t]}(r),this.render()}render(){new v(this.vm,this.listExp,"for",(t=>{this.updater(t)}))}updater(t){const s=document.createDocumentFragment(),n=function(t){switch(e(t)){case"string":case"array":return t.length;case"object":return Object.values(t).length;case"number":return Math.max(0,Number(t));default:return 0}}(t),i=this.startIndex+n-1,r=new w(this);if(Array.from({length:n}).forEach(((e,n)=>{const i=this.el.cloneNode(!0);var o;(o=i).removeAttribute("v-for"),o.removeAttribute(":key"),o.removeAttribute("v-bind:key");const c=r.bind(i,n,t);s.appendChild(c)})),this.el.isConnected)this.parent.replaceChild(s,this.el),this.endIndex=i;else{for(let t=this.endIndex;t>=this.startIndex;t--){const e=this.parent.children[t];e&&this.parent.removeChild(e)}this.el.remove();const t=this.parent.children[this.startIndex];this.parent.insertBefore(s,t),this.endIndex=this.startIndex+n-1}this.clearEffects()}clearEffects(){this.loopEffects.forEach((t=>t())),this.loopEffects=[]}}class O{constructor(t,e,s,n,i){this.vm=e,this.node=s,this.exp=n;const{key:r,modifier:o}=function(t){if([":","@"].includes(t[0]))return":"===t.slice(0,1)?{key:"bind",modifier:t.slice(1)}:{key:"on",modifier:t.slice(1)};{const e=/^v-([\w-]+)(:(\w+))?$/,s=t.match(e);return{key:s[1],modifier:s[3]||null}}}(t);this.directiveName=r,this.modifier=o,(t=>l.includes(t))(r)&&(((t,e)=>t.startsWith("else")||"bind"===t&&"key"===e)(r,o)||(!function(t){return"if"===t||"for"===t}(r)?(!function(t){return t.startsWith("v-on:")||t.startsWith("@")}(t)?this[r]():this.on(),s instanceof HTMLElement&&s.removeAttribute(t)):this.scheduleTask(r,i)))}bind(t){t=this.selectUpdater(t),new v(this.vm,this.exp,this.directiveName,(e=>{t(this.node,e)}))}model(){const e=this.node;switch(e.tagName){case"INPUT":{const s=e;"checkbox"===s.type?(s.addEventListener("change",(e=>{const s=e.target.checked;t(this.vm,this.exp,s)})),this.bind(p.inputCheckbox)):"radio"===s.type?(s.name=this.exp,s.addEventListener("change",(e=>{const s=e.target.value;t(this.vm,this.exp,s)})),this.bind(p.inputRadio)):(s.addEventListener("input",(e=>{const s=e.target.value;t(this.vm,this.exp,s)})),this.bind(p.inputValue));break}case"TEXTAREA":e.addEventListener("input",(e=>{const s=e.target.value;t(this.vm,this.exp,s)})),this.bind(p.inputValue);break;case"SELECT":{const s=e;s.multiple?(s.addEventListener("change",(e=>{const s=e.target,n=Array.from(s.selectedOptions).map((t=>t.value));t(this.vm,this.exp,n)})),this.bind(p.inputMultiple)):(s.addEventListener("change",(e=>{const s=e.target.value;t(this.vm,this.exp,s)})),this.bind(p.inputValue));break}default:throw new Error(`Unsupported element type: ${e.tagName}`)}}text(){this.bind(p.text.bind(this))}style(){this.bind(p.style)}class(){this.bind(p.class)}html(){this.bind(p.html)}show(){this.bind(p.show)}on(){const t=(e=this.vm,this.exp.trim().split(".").reduce(((t,e)=>t&&Object.hasOwn(t,e)?t[e]:null),e));var e;if("function"==typeof t)this.node.addEventListener(this.modifier,t);else{const t=m(this.vm,`function(){ ${this.exp} }`);this.node.addEventListener(this.modifier,t)}}scheduleTask(t,e){const s={...$.context},n="if"===t?g:k,i=()=>new n(this.vm,this.node,this.exp,s);e?e.push(i):this.vm.deferredTasks.push(i)}selectUpdater(t){const e=this.modifier;return"text"===e||"class"===e||"style"===e?p[e].bind(this):t||(e?p.customBind.bind(this):p.objectBind.bind(this))}}class j{constructor(t,e,s){this.vm=t,this.node=e,this.loopEffects=s;const r=e.textContent;n(e)?this.directiveBind(e):i(e)&&/{{\s*(.*?)\s*}}/.test(r)&&!(t=>{const e=null==t?void 0:t.attributes;if(e)return Array.from(e).some((t=>"v-text"===t.name))})(e.parentElement)&&this.templateBind(e)}directiveBind(t){Array.from(t.attributes).forEach((({name:e,value:s})=>{if(u(e)){s=E($.context,s),new O(e,this.vm,t,s,this.loopEffects)}}))}templateBind(t){let e=t.textContent;e=E($.context,e),new O("v-text",this.vm,t,e)}}class C{constructor(t){this.visitor=t}visit(t,e){this.visitor.visit(t,e)}}class T extends C{node2Fragment(t){const e=document.createDocumentFragment();let s;for(;s=t.firstChild;)e.appendChild(s);return e}scan(t){const e=e=>{f(e)&&new j(t,e)};t.template?(this.fragment=this.node2Fragment(t.template),t.el.innerHTML=""):this.fragment=this.node2Fragment(t.el),e(this.fragment),this.visit(e,this.fragment),t.el.appendChild(this.fragment),t.clearTasks()}scanPartial(t,e,s){const n=this.node2Fragment(e),i=e=>{f(e)&&new j(t,e,s)};return i(n),this.visit(i,n),e.appendChild(n),e}}class ${constructor(t){this.deferredTasks=[],this.el=document.querySelector(t.el),this.options=t,this.template=function(t){if(!t)return;const e=document.createElement("div");return e.innerHTML=t,e.firstElementChild}(t.template),a(this),function(t){const{styles:e}=t.options;if(!e)return;const s=document.createElement("style");document.head.appendChild(s),Object.entries(e).forEach((([t,e])=>{const n=new h(s.sheet);n.selector(t),Object.entries(e).forEach((([t,e])=>{n.setStyle(t,e)}))}))}(this);new T(new x).scan(this)}clearTasks(){this.deferredTasks.forEach((t=>t())),this.deferredTasks=[]}}return $}));
