!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Vuelite=e()}(this,(function(){"use strict";function t(t,e){return(e=e.trim()).split(".").reduce(((t,e)=>t&&Object.hasOwn(t,e)?t[e]:null),t)}function e(t,e,s){e=e.trim();let i=t;e.split(".").forEach(((t,e,n)=>{if(e===n.length-1)i[t]=s;else{if(!Object.hasOwn(i,t))return;i=i[t]}}))}const s=t=>{return"object"===(e=t,Object.prototype.toString.call(e).slice(8,-1).toLowerCase());var e};function i(t){return/^["'].*["']$/.test(t)&&t[0]===t[t.length-1]}const n=t=>1===t.nodeType,r=t=>3===t.nodeType;class o{constructor(){this.listener=new Set}subscribe(t){this.listener.add(t)}unsubscribe(t){this.listener.delete(t)}notify(){this.listener.forEach((t=>{t.update()}))}depend(){var t;null===(t=o.activated)||void 0===t||t.addDep(this)}}o.activated=null;class c{constructor(t){this.proxy=this.define(t)}define(t){const e=this,i=new Map,n=new Map;return new Proxy(t,{get(t,r,c){n.has(r)||n.set(r,new o),n.get(r).depend();const a=t[r];return s(a)?(i.has(r)||i.set(r,e.define(a)),i.get(r)):Reflect.get(t,r,c)},set(t,e,s,i){const r=Reflect.set(t,e,s,i);return n.has(e)&&n.get(e).notify(),r}})}}function a(t){const{data:e}=t.options,s="function"==typeof e?e():{},i=new c(s).proxy;for(const e in s)Object.defineProperty(t,e,{configurable:!1,get:()=>i[e],set:t=>{i[e]=t}});!function(t){const{methods:e}=t.options;if(!e)return;Object.entries(e).forEach((([e,s])=>{if(Object.hasOwn(t,e))throw new Error(`${e} has already been declared`);Object.defineProperty(t,e,{value:(...e)=>s.apply(t,e)})}))}(t),function(t){const{computed:e}=t.options;if(!e)return;for(const s in e)if(Object.hasOwn(t,s))throw new Error(`${s} has already been declared`);Object.entries(e).forEach((([e,s])=>{const i={};!function(t){return"function"!=typeof t}(s)?i.get=()=>s.call(t):(i.get=s.get.bind(t),i.set=(...e)=>{s.set.apply(t,e)}),Object.defineProperty(t,e,i)}))}(t)}class l{constructor(t){const e=t.cssRules.length;t.insertRule("*{}",e),this.rule=t.cssRules[e]}selector(t){this.rule.selectorText=t}setStyle(t,e){this.rule.style[t]=e}}const h=["bind","model","text","style","class","html","eventHandler","if","else","show"];function d(t){const e=/{{\s*(.*?)\s*}}/g,s=[];let i;for(;null!==(i=e.exec(t));)s.push(i[1]);return s}function u(t){return t.startsWith("v-")||t.startsWith(":")||t.startsWith("@")}const f={text(t,e){t.textContent=e},class(t,e){s(e)&&Object.entries(e).forEach((([e,s])=>{s&&t.classList.add(e)}))},style(t,e){for(const[s,n]of Object.entries(e))i(n)?t.style[s]=n.slice(1,-1):t.style[s]=n},html(t,e){t.innerHTML=e},inputCheckbox(t,e){t.checked=e},inputRadio(t,e){t.checked=t.value===e},inputValue(t,e){t.value=e},inputMultiple(t,e){const s=Array.from(t.options);Array.isArray(e)&&s.forEach((t=>{t.selected=e.includes(t.value)}))},customBind(t,e){t.setAttribute(this.modifier,e)},objectBind(t,e){s(e)&&Object.entries(e).forEach((([e,s])=>t.setAttribute(e,s)))},if(t,e){},else(t){},show(t,e){t._originalDisplay||(t._originalDisplay=window.getComputedStyle(t).display),t.style.display=e?t._originalDisplay||"block":"none"}};function p(t,e){const s=d(e).reduce(((e,s)=>(e[s]=function(t,e){try{return new Function(`\n      with (this) {\n        return ${e};\n      }\n    `).call(t)}catch(t){return}}(t,s),e)),{});return e.replace(/{{\s*(.*?)\s*}}/g,((t,e)=>s[e]||""))}class m{constructor(t,e,s,i){this.vm=t,this.exp=e,this.directiveName=s,this.onUpdate=i,this.deps=new Set,this.value=this.getterTrigger(),i(this.value)}addDep(t){t.subscribe(this),this.deps.add(t)}getterTrigger(){o.activated=this;const e="text"===this.directiveName?p(this.vm,this.exp):function(e,s){let n;if(/^\{(\s*[a-zA-Z_$][a-zA-Z_$0-9]*\s*:\s*[^{}]+\s*,?\s*)+\}$/.test(s)){const r=JSON.parse(s.replace(/(\w+):/g,'"$1":').replace(/:\s*([^,\s{}]+)/g,((t,e)=>/^".*"$/.test(e)?t:`: "${e}"`)));n=Object.entries(r).reduce(((s,[n,r])=>(i(r)?s[n]=function(t){return"true"===t||"false"!==t&&t}(r.slice(1,-1)):s[n]=t(e,r),s)),r)}else{const i=function(t){const e=t.match(/^\s*(\w+(\.\w+)*)\(\)\s*$/);return e?e[1]:null}(s);n=i?t(e,i).call(e):t(e,s)}return n}(this.vm,this.exp);return o.activated=null,e}update(){const t=this.value,e=this.getterTrigger();t!==e&&(this.value=e,this.onUpdate.call(this.vm,e))}}class v{constructor(t,e,s,i){this.vm=t,this.el=e,this.name=s,this.exp=i,this.parent=e.parentElement||t.el,this.childIndex=Array.from(this.parent.children).indexOf(e),this.fragment=document.createDocumentFragment(),this.render()}render(){new m(this.vm,this.exp,this.name,(t=>{this.updater(t)}))}updater(t){if(this.isVisible)t||(this.isVisible=!1,this.fragment.appendChild(this.el));else if(t){this.isVisible=!0;const t=Array.from(this.parent.children)[this.childIndex];this.parent.insertBefore(this.fragment,t)}else this.fragment.appendChild(this.el)}}class b{constructor(t,e,s,i){this.vm=e,this.node=s,this.exp=i;const{key:n,modifier:r}=function(t){if([":","@"].includes(t[0]))return":"===t.slice(0,1)?{key:"bind",modifier:t.slice(1)}:{key:"eventHandler",modifier:t.slice(1)};{const e=/^v-(\w+)(:(\w+))?$/,s=t.match(e);return{key:s[1],modifier:s[3]||null}}}(t);this.directiveName=n,this.modifier=r,(t=>h.includes(t))(n)&&("if"===n?e.deferredTasks.push((()=>new v(e,s,n,i))):(!function(t){return t.startsWith("v-on:")||t.startsWith("@")}(t)?this[n]():this.eventHandler(),s instanceof HTMLElement&&s.removeAttribute(t)))}bind(t){const e=this.modifier;"text"!==e&&"class"!==e&&"style"!==e||(t=f[e].bind(this)),t||(t=e?f.customBind.bind(this):f.objectBind.bind(this)),new m(this.vm,this.exp,this.directiveName,(e=>{t&&t(this.node,e)}))}model(){const t=this.node;switch(t.tagName){case"INPUT":{const s=t;"checkbox"===s.type?(s.addEventListener("change",(t=>{const s=t.target.checked;e(this.vm,this.exp,s)})),this.bind(f.inputCheckbox)):"radio"===s.type?(s.name=this.exp,s.addEventListener("change",(t=>{const s=t.target.value;e(this.vm,this.exp,s)})),this.bind(f.inputRadio)):(s.addEventListener("input",(t=>{const s=t.target.value;e(this.vm,this.exp,s)})),this.bind(f.inputValue));break}case"TEXTAREA":t.addEventListener("input",(t=>{const s=t.target.value;e(this.vm,this.exp,s)})),this.bind(f.inputValue);break;case"SELECT":{const s=t;s.multiple?(s.addEventListener("change",(t=>{const s=t.target,i=Array.from(s.selectedOptions).map((t=>t.value));e(this.vm,this.exp,i)})),this.bind(f.inputMultiple)):(s.addEventListener("change",(t=>{const s=t.target.value;e(this.vm,this.exp,s)})),this.bind(f.inputValue));break}default:throw new Error(`Unsupported element type: ${t.tagName}`)}}text(){this.bind(f.text.bind(this))}style(){this.bind(f.style)}class(){this.bind(f.class)}html(){this.bind(f.html)}if(){}else(){}show(){this.bind(f.show)}eventHandler(){const e=t(this.vm,this.exp);"function"==typeof e&&this.node.addEventListener(this.modifier,e)}}class g{constructor(t,e){this.vm=t,this.node=e;const s=e.textContent;n(e)?this.directiveBind(e):r(e)&&/{{\s*(.*?)\s*}}/.test(s)&&!(t=>{const e=null==t?void 0:t.attributes;if(e)return Array.from(e).some((t=>"v-text"===t.name))})(e.parentElement)&&this.templateBind(e)}directiveBind(t){Array.from(t.attributes).forEach((({name:e,value:s})=>{u(e)&&new b(e,this.vm,t,s)}))}templateBind(t){new b("v-text",this.vm,t,t.textContent)}}class y{constructor(t){this.visitor=t}visit(t,e){this.visitor.visit(t,e)}}class x extends y{node2Fragment(t){const e=document.createDocumentFragment();let s;for(;s=t.firstChild;)e.appendChild(s);this.fragment=e}scan(t){const e=e=>{(t=>{if(n(t)){const e=t.attributes;return Array.from(e).some((t=>u(t.name)))}if(r(t))return d(t.textContent||"").length>0})(e)&&new g(t,e)};t.template?(this.node2Fragment(t.template),t.el.innerHTML=""):this.node2Fragment(t.el),e(this.fragment),this.visit(e,this.fragment),t.el.appendChild(this.fragment),t.deferredTasks.forEach((t=>t()))}}class w{visit(t,e){let s;const i=[e.firstChild];for(;s=i.pop();)s&&(t(s),s.firstChild&&i.push(s.firstChild),s.nextSibling&&i.push(s.nextSibling))}}return class{constructor(t){this.deferredTasks=[],this.el=document.querySelector(t.el),this.options=t,this.template=function(t){if(!t)return;const e=document.createElement("div");return e.innerHTML=t,e.firstElementChild}(t.template),a(this),function(t){const{styles:e}=t.options;if(!e)return;const s=document.createElement("style");document.head.appendChild(s),Object.entries(e).forEach((([t,e])=>{const i=new l(s.sheet);i.selector(t),Object.entries(e).forEach((([t,e])=>{i.setStyle(t,e)}))}))}(this);new x(new w).scan(this)}}}));
